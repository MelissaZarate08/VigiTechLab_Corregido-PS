import t from"https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.esm.js";import{r as p}from"./logeoService-DGcYLc-w.js";import{n as f}from"./index-DG_JPB1t.js";function g(){const l=document.getElementById("register-form"),r=document.getElementById("register-role"),e=document.getElementById("register-systemID");r.addEventListener("change",()=>{const o=r.value;o==="admin"?(e.disabled=!0,e.value="",e.placeholder="No requerido para administradores",e.style.opacity="0.5",e.style.cursor="not-allowed"):o==="user"?(e.disabled=!1,e.placeholder="00001",e.style.opacity="1",e.style.cursor="text"):(e.disabled=!0,e.value="",e.placeholder="Selecciona primero tu rol",e.style.opacity="0.5",e.style.cursor="not-allowed")}),e.disabled=!0,e.placeholder="Selecciona primero tu rol",e.style.opacity="0.5",e.style.cursor="not-allowed",l.addEventListener("submit",async o=>{o.preventDefault();const d=document.getElementById("register-name").value.trim(),m=document.getElementById("register-email").value.trim(),n=document.getElementById("register-password").value,c=document.getElementById("register-confirm-password").value,s=r.value,i=parseInt(e.value,10)||void 0;if(n!==c)return t.fire({toast:!0,position:"top-end",icon:"error",title:"Las contraseñas no coinciden",showConfirmButton:!1,timer:2e3});if(s==="user"&&!i)return t.fire({toast:!0,position:"top-end",icon:"warning",title:"ID de sistema requerido para usuario",showConfirmButton:!1,timer:2e3});if(s==="admin"&&i)return t.fire({toast:!0,position:"top-end",icon:"warning",title:"Los administradores no requieren ID de sistema",showConfirmButton:!1,timer:2e3});try{await p({name:d,email:m,password:n,role:s,id_Sistema:i}),await t.fire({toast:!0,position:"top-end",icon:"success",title:"Registrado con éxito",showConfirmButton:!1,timer:2e3}),f("#/login")}catch(a){const u=a.message==="ID de sistema inválido para este rol"?"ID de sistema no autorizado":a.message||"Error al registrarse";t.fire({toast:!0,position:"top-end",icon:"error",title:u,showConfirmButton:!1,timer:2500})}})}document.addEventListener("DOMContentLoaded",g);export{g as initRegister};
